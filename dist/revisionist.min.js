/**
 *  v0.0.1
 *
 * Copyright (c) 2013Bruno Abrantes
 * Distributed under MIT License
 *
 * Documentation and full license available at:
 * http://inf0rmer.github.com/revisionist
 *
 */
!function(a){if("function"==typeof bootstrap)bootstrap("revisionist",a);else if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeRevisionist=a}else"undefined"!=typeof window?window.Revisionist=a():global.Revisionist=a()}(function(){return function(a,b,c){function d(c,f){if(!b[c]){if(!a[c]){var g="function"==typeof require&&require;if(!f&&g)return g(c,!0);if(e)return e(c,!0);throw new Error("Cannot find module '"+c+"'")}var h=b[c]={exports:{}};a[c][0].call(h.exports,function(b){var e=a[c][1][b];return d(e?e:b)},h,h.exports)}return b[c].exports}for(var e="function"==typeof require&&require,f=0;f<c.length;f++)d(c[f]);return d}({1:[function(a,b){function c(a){var b=a;return b=b.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/"/g,"&quot;")}function d(a,b){a=a.replace(/\s+$/,""),b=b.replace(/\s+$/,"");var d=e(""==a?[]:a.split(/\s+/),""==b?[]:b.split(/\s+/)),f="",g=a.match(/\s+/g);null==g?g=["\n"]:g.push("\n");var h=b.match(/\s+/g);if(null==h?h=["\n"]:h.push("\n"),0==d.n.length)for(var i=0;i<d.o.length;i++)f+="<del>"+c(d.o[i])+g[i]+"</del>";else{if(null==d.n[0].text)for(b=0;b<d.o.length&&null==d.o[b].text;b++)f+="<del>"+c(d.o[b])+g[b]+"</del>";for(var i=0;i<d.n.length;i++)if(null==d.n[i].text)f+="<ins>"+c(d.n[i])+h[i]+"</ins>";else{var j="";for(b=d.n[i].row+1;b<d.o.length&&null==d.o[b].text;b++)j+="<del>"+c(d.o[b])+g[b]+"</del>";f+=" "+d.n[i].text+h[i]+j}}return f}function e(a,b){for(var c=new Object,d=new Object,e=0;e<b.length;e++)null==c[b[e]]&&(c[b[e]]={rows:new Array,o:null}),c[b[e]].rows.push(e);for(var e=0;e<a.length;e++)null==d[a[e]]&&(d[a[e]]={rows:new Array,n:null}),d[a[e]].rows.push(e);for(var e in c)1==c[e].rows.length&&"undefined"!=typeof d[e]&&1==d[e].rows.length&&(b[c[e].rows[0]]={text:b[c[e].rows[0]],row:d[e].rows[0]},a[d[e].rows[0]]={text:a[d[e].rows[0]],row:c[e].rows[0]});for(var e=0;e<b.length-1;e++)null!=b[e].text&&null==b[e+1].text&&b[e].row+1<a.length&&null==a[b[e].row+1].text&&b[e+1]==a[b[e].row+1]&&(b[e+1]={text:b[e+1],row:b[e].row+1},a[b[e].row+1]={text:a[b[e].row+1],row:e+1});for(var e=b.length-1;e>0;e--)null!=b[e].text&&null==b[e-1].text&&b[e].row>0&&null==a[b[e].row-1].text&&b[e-1]==a[b[e].row-1]&&(b[e-1]={text:b[e-1],row:b[e].row-1},a[b[e].row-1]={text:a[b[e].row-1],row:e-1});return{o:a,n:b}}b.exports=d},{}],2:[function(a,b){var c;c=function(a,b){var d;null==a&&(a={});for(d in b)a[d]="object"==typeof b[d]?c(a[d],b[d]):b[d];return a},b.exports=c},{}],3:[function(a,b){var Revisionist,c,d,e;e=a("./lib/diff"),d=a("./lib/extend.coffee"),Revisionist=function(){function Revisionist(a){this.options={},d(this.options,this.defaults),d(this.options,a)}var a,b,c,f;return a=[],f={},b=0,c=function(){var a;return a=b-1,0>a&&(a=0),a},Revisionist.registerPlugin=function(a,b){if(null!=f[a])throw new Error("There's already a plugin in this namespace");return f[a]=b},Revisionist.unregisterPlugin=function(a){if(null==f[a])throw new Error("This plugin doesn't exist");return f[a]=null},Revisionist.prototype.defaults={versions:10,plugin:"simple"},Revisionist.prototype.getLatestVersionNumber=function(){return b-1},Revisionist.prototype.change=function(c){var d;if(d=f[this.options.plugin],null==(null!=d?d.change:void 0))throw new Error("Plugin "+this.options.plugin+" is not available!");return c=d.change.call(d,c),b+=1,a.push(c),b>this.options.versions&&(a.shift(),b=a.length),c},Revisionist.prototype.recover=function(b){var d;if(d=f[this.options.plugin],null==(null!=d?d.recover:void 0))throw new Error("Plugin "+this.options.plugin+" is not available!");if(null==b&&(b=c()),0>b)throw new Error("Version needs to be a positive number");if(b>a.length)throw new Error("This version doesn't exist");return d.recover.call(d,a[b])},Revisionist.prototype.diff=function(a,c){var d,e;return null==a&&(a=b-1,0>a&&(a=0)),null==c&&(c=a-1,0>c&&(c=0)),e=Math.min(a,c),d=Math.max(a,c),{old:this.recover(e),"new":this.recover(d)}},Revisionist.prototype.visualDiff=function(a,b){var c;if(c=this.diff(a,b),"string"!=typeof c.old||"string"!=typeof c["new"])throw new Error("The content types of both versions must match");return e(c.old,c["new"])},Revisionist.prototype.clear=function(){return a=[],b=0},Revisionist}(),c={change:function(a){return a},recover:function(a){return a}},Revisionist.registerPlugin("simple",c),b.exports=Revisionist},{"./lib/diff":1,"./lib/extend.coffee":2}]},{},[3])(3)});