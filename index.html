<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=640" />

    <link rel="stylesheet" href="stylesheets/core.css" media="screen"/>
    <link rel="stylesheet" href="stylesheets/mobile.css" media="handheld, only screen and (max-device-width:640px)"/>
    <link rel="stylesheet" href="stylesheets/pygment_trac.css"/>

    <script type="text/javascript" src="javascripts/modernizr.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" src="javascripts/headsmart.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function () {
        $('#main_content').headsmart()
      })
    </script>
    <title>Revisionist by inf0rmer</title>
  </head>

  <body>
    <a id="forkme_banner" href="https://github.com/inf0rmer/revisionist">View on GitHub</a>
    <div class="shell">

      <header>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <h1>Revisionist</h1>
            <h2>A simple utility to help you manage content revisions.</h2>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
      </header>

      <section id="downloads">
        <span class="inner">
          <a href="https://github.com/inf0rmer/revisionist/zipball/master" class="zip"><em>download</em> .ZIP</a><a href="https://github.com/inf0rmer/revisionist/tarball/master" class="tgz"><em>download</em> .TGZ</a>
        </span>
      </section>


      <span class="banner-fix"></span>


      <section id="main_content">
        <p><a href="https://travis-ci.org/inf0rmer/revisionist"><img src="https://travis-ci.org/inf0rmer/revisionist.png?branch=master" alt="Build Status"></a></p>

<h1>
<a name="overview" class="anchor" href="#overview"><span class="octicon octicon-link"></span></a>Overview</h1>

<p>Revisionist is a simple tool to help you manage versions of content in your web application.
Everytime your data changes, you can save it as a revision in a Revisionist instance.
You can then access the last x versions of your content (10 by default).</p>

<p>Revisionist is open source. View the <a href="http://inf0rmer.github.io/revisionist/docs/annotated.html">annotated source code</a>.</p>

<h1>
<a name="get-it" class="anchor" href="#get-it"><span class="octicon octicon-link"></span></a>Get it</h1>

<h2>
<a name="through-bower" class="anchor" href="#through-bower"><span class="octicon octicon-link"></span></a>Through <a href="http://bower.io/">Bower</a>
</h2>

<p><code>bower install revisionist</code></p>

<h2>
<a name="through-npm" class="anchor" href="#through-npm"><span class="octicon octicon-link"></span></a>Through <a href="https://npmjs.org/">NPM</a>
</h2>

<p><code>npm install revisionist</code></p>

<h1>
<a name="how-to-use-it" class="anchor" href="#how-to-use-it"><span class="octicon octicon-link"></span></a>How to use it</h1>

<h2>
<a name="in-a-script-tag" class="anchor" href="#in-a-script-tag"><span class="octicon octicon-link"></span></a>In a <code>&lt;script&gt;</code> tag</h2>

<p>Include the script in your page. A global "Revisionist" variable will be made available.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">rev</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">window</span><span class="p">.</span><span class="nx">Revisionist</span><span class="p">()</span>
</pre></div>

<h2>
<a name="with-an-amd-loader" class="anchor" href="#with-an-amd-loader"><span class="octicon octicon-link"></span></a>With an AMD loader</h2>

<p>Using an AMD loader such as <a href="http://requirejs.org">RequireJS</a>:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">require</span><span class="p">([</span><span class="s1">'path/to/revisionist'</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Revisionist</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">rev</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Revisionist</span><span class="p">()</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="in-node" class="anchor" href="#in-node"><span class="octicon octicon-link"></span></a>In Node</h2>

<div class="highlight highlight-javascript"><pre><span class="nx">Revisionist</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'path/to/revisionist'</span><span class="p">)</span>
<span class="nx">rev</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Revisionist</span><span class="p">()</span>
</pre></div>

<h1>
<a name="api" class="anchor" href="#api"><span class="octicon octicon-link"></span></a>API</h1>

<p>Any instance has these two methods available:</p>

<p><strong>change(newValue)</strong></p>

<p>Creates a new revision. It returns the same value you passed in</p>

<div class="highlight highlight-javascript"><pre><span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'bananas'</span><span class="p">)</span>
<span class="c1">// -&gt; 'bananas'</span>
</pre></div>

<p><strong>recover(version, callback)</strong></p>

<p>Asynchronously recovers a previous version of your content.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'tomatoes'</span><span class="p">)</span>

<span class="nx">rev</span><span class="p">.</span><span class="nx">recover</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
  <span class="c1">// data === 'bananas'</span>
<span class="p">})</span>

<span class="nx">rev</span><span class="p">.</span><span class="nx">recover</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
  <span class="c1">// data === 'tomatoes'</span>
<span class="p">})</span>
</pre></div>

<p><strong>diff(version1, version2, callback)</strong></p>

<p>Asynchronously presents the difference between two versions.
If no parameters are passed in, the two latest versions are assumed.
If only the first parameter is passed, it is checked against the version before it.</p>

<p>This function uses the Store's <code>get</code> methods directly instead of Revisionist's <code>recover</code>, so the Plugin's code will not run when calling <code>diff</code>.</p>

<p>Calling diff returns a hash with two keys, <code>old</code> and <code>new</code>, containing the values for the oldest and newest versions passed in.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="nx">rev</span><span class="p">.</span><span class="nx">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">hash</span><span class="p">){</span>
  <span class="c1">// hash == { old: 2, new: 10 }</span>
<span class="p">})</span>
</pre></div>

<p><strong>visualDiff(version1, version2, callback)</strong></p>

<p>This function will produce an HTML annotated diff string. If any non-String values are detected, an Error will be thrown.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'fox'</span><span class="p">)</span>
<span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'the brown fox jumped over the lazy wizard'</span><span class="p">)</span>

<span class="nx">rev</span><span class="p">.</span><span class="nx">visualDiff</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">html</span><span class="p">){</span>
  <span class="c1">// html === &lt;ins&gt;the &lt;/ins&gt;&lt;ins&gt;brown &lt;/ins&gt; fox &lt;ins&gt;jumped &lt;/ins&gt;&lt;ins&gt;over &lt;/ins&gt;&lt;ins&gt;the &lt;/ins&gt;&lt;ins&gt;lazy &lt;/ins&gt;&lt;ins&gt;wizard\n&lt;/ins&gt;</span>
<span class="p">})</span>
</pre></div>

<p><strong>getLatestVersionNumber</strong></p>

<p>Returns the index for the last saved version. The earliest version stored is always 0, so:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'once'</span><span class="p">)</span>
<span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'twice'</span><span class="p">)</span>
<span class="nx">rev</span><span class="p">.</span><span class="nx">change</span><span class="p">(</span><span class="s1">'thrice'</span><span class="p">)</span>

<span class="nx">rev</span><span class="p">.</span><span class="nx">getLatestVersionNumber</span><span class="p">()</span>
<span class="c1">// -&gt; 2</span>
</pre></div>

<p><strong>clear</strong></p>

<p>Clears the internal cache for this instance.</p>

<h1>
<a name="options" class="anchor" href="#options"><span class="octicon octicon-link"></span></a>Options</h1>

<p>When creating a Revisionist instance, you can pass it an options hash to change the default behaviour. The available options are:</p>

<p><strong>versions | Number</strong></p>

<p>The maximum number of revisions you wish to store. Defaults to 10.</p>

<p><strong>plugin | String</strong></p>

<p>The plugin you wish to use with this instance. The plugin must have been registered before using the class method <code>registerPlugin</code></p>

<h1>
<a name="plugin-architecture" class="anchor" href="#plugin-architecture"><span class="octicon octicon-link"></span></a>Plugin Architecture</h1>

<p>Revisionist uses a plugin architecture, so you can wrap around it's two main functions, <code>change</code> and <code>recover</code> to implement your own logic.</p>

<p>The "Simple" plugin shipped by default simply stores and returns the values as they're passed in.</p>

<h2>
<a name="authoring-a-plugin" class="anchor" href="#authoring-a-plugin"><span class="octicon octicon-link"></span></a>Authoring a plugin</h2>

<p>To write a plugin, all you really have to do is provide Revisionist with a hash containing two methods:</p>

<p><strong>change(newValue)</strong></p>

<p>This method will be called by the Revisionist instance when you do <code>instance.change("bananas")</code>. In this case, your implementation of <code>change</code> would receive an argument with a value of <code>bananas</code>.</p>

<p><strong>recover(oldValue)</strong></p>

<p>This method will be called by the Revisionist instance when you do <code>instance.recover(2)</code>. Your implementation of <code>recover</code> gets an argument with the value previously stored as revision #2.</p>

<p>Both of these methods are executed in the context of your own plugin.</p>

<h3>
<a name="registering-and-unregistering-a-plugin" class="anchor" href="#registering-and-unregistering-a-plugin"><span class="octicon octicon-link"></span></a>Registering and Unregistering a plugin</h3>

<p>The <code>Revisionist</code> class exposes a class method to register your plugins.</p>

<p><strong>registerPlugin(name, hash)</strong></p>

<p>Registers a plugin with a name and a hash containing <code>change</code> and <code>recover</code> functions. If your plugin does not follow this naming convention, it will not work properly.</p>

<p>Example:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">MyPlugin</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">change</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{},</span>
  <span class="nx">recover</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">oldValue</span><span class="p">)</span> <span class="p">{}</span>
<span class="p">}</span>

<span class="nx">Revisionist</span><span class="p">.</span><span class="nx">registerPlugin</span><span class="p">(</span><span class="s1">'myPlugin'</span><span class="p">,</span> <span class="nx">MyPlugin</span><span class="p">);</span>
</pre></div>

<p><strong>unregisterPlugin(name)</strong></p>

<p>Unregisters a plugin with a given name.</p>

<p>Example:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">Revisionist</span><span class="p">.</span><span class="nx">unregisterPlugin</span><span class="p">(</span><span class="s1">'myPlugin'</span><span class="p">)</span>
<span class="c1">// MyPlugin is not available anymore</span>
</pre></div>

<h1>
<a name="store-architecture" class="anchor" href="#store-architecture"><span class="octicon octicon-link"></span></a>Store Architecture</h1>

<p>Revisionist uses a store architecture, so if you require more advanced storage functions (ie. localStorage, Redis, etc) you can write your own Store class.</p>

<p>The "Simple" store shipped by default stores the values using an in-memory cache in the form of an array.</p>

<h2>
<a name="authoring-a-store" class="anchor" href="#authoring-a-store"><span class="octicon octicon-link"></span></a>Authoring a Store</h2>

<p>To write a store, you need to provide Revisionist with a Function with certain public API methods (plus anything else you might want).</p>

<h3>
<a name="defining-the-store-constructor" class="anchor" href="#defining-the-store-constructor"><span class="octicon octicon-link"></span></a>Defining the Store constructor</h3>

<p>Using CoffeeScript:</p>

<div class="highlight highlight-coffeescript"><pre>
<span class="k">class</span> <span class="nx">MyStore</span>
  <span class="nv">constructor: </span><span class="nf">(options) -&gt;</span>
    <span class="c1"># Initialize here...</span>

  <span class="nv">set: </span><span class="nf">(value, version) -&gt;</span>
    <span class="c1"># Your implementation of "set"...</span>

  <span class="nv">myMethod: </span><span class="nf">-&gt;</span>
    <span class="c1"># Your implementation of "myMethod"...</span>

</pre></div>

<p>Using Javascript:</p>

<div class="highlight highlight-javascript"><pre>
<span class="kd">function</span> <span class="nx">MyStore</span><span class="p">(</span><span class="nx">options</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Initialize here...</span>
<span class="p">}</span>

<span class="nx">MyStore</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">set</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">version</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// Your implementation of "set"...</span>
<span class="p">};</span>

<span class="nx">MyStore</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">myMethod</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="c1">// Your implementation of "myMethod"...</span>
<span class="p">};</span>

</pre></div>

<p>The function constructor automatically receives the Revisionist instance options hash as an argument.</p>

<h3>
<a name="store-api" class="anchor" href="#store-api"><span class="octicon octicon-link"></span></a>Store API</h3>

<p><strong>set (value, version)</strong></p>

<p>Stores a new version. The value is user-supplied and the version number is an Integer supplied by Revisionist stating which version number should be saved.</p>

<p><strong>get (version)</strong></p>

<p>Retrieves the value for a specific version. The version number is an Integer supplied by Revisionist. It is already clamped to minimize chances that the version number is invalid.</p>

<p><strong>remove (version)</strong></p>

<p>Removes a version from the Store. This is typically called by Revisionist automatically when the Store's size reaches the maximum number of versions allowed.</p>

<p><strong>clear</strong></p>

<p>Fully empties the Store.</p>

<p><strong>size</strong></p>

<p>This should return an Integer containing the current size of the Store.</p>

<h3>
<a name="registering-and-unregistering-a-store" class="anchor" href="#registering-and-unregistering-a-store"><span class="octicon octicon-link"></span></a>Registering and Unregistering a Store</h3>

<p>The <code>Revisionist</code> class exposes a class method to register your stores.</p>

<p><strong>registerStore(name, Store)</strong></p>

<p>Registers a store with a name and a constructor that follows the Store API. If your store does not implement these API methods, it will not work properly.</p>

<p>Example:</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">MyStore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">options</span><span class="p">){</span>
  <span class="c1">//...</span>
<span class="p">}</span>
<span class="nx">MyStore</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{}</span>
<span class="p">...</span>

<span class="nx">Revisionist</span><span class="p">.</span><span class="nx">registerStore</span><span class="p">(</span><span class="s1">'myStore'</span><span class="p">,</span> <span class="nx">MyStore</span><span class="p">);</span>
</pre></div>

<p><strong>unregisterStore(name)</strong></p>

<p>Unregisters a store with a given name.</p>

<p>Example:</p>

<div class="highlight highlight-javascript"><pre><span class="nx">Revisionist</span><span class="p">.</span><span class="nx">unregisterStore</span><span class="p">(</span><span class="s1">'myStore'</span><span class="p">)</span>
<span class="c1">// MyStore is not available anymore</span>
</pre></div>
      </section>

      <footer>
        <span class="ribbon-outer">
          <span class="ribbon-inner">
            <p>this project by <a href="https://github.com/inf0rmer">inf0rmer</a> can be found on <a href="https://github.com/inf0rmer/revisionist">GitHub</a></p>
          </span>
          <span class="left-tail"></span>
          <span class="right-tail"></span>
        </span>
        <p>Generated with <a href="http://pages.github.com">GitHub Pages</a> using Merlot</p>
        <span class="octocat"></span>
      </footer>

    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-5722833-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
